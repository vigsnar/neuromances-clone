

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Graph Dynamics &mdash; NeuroMANCER 1.2.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/tiny_dadaist.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Integrators" href="integrators.html" />
    <link rel="prev" title="GNN" href="gnn.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> NeuroMANCER
          

          
            
            <img src="_static/dadaist.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Modules:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dynamics.html">Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="activations.html">Activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="blocks.html">Blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="estimators.html">Estimators</a></li>
<li class="toctree-l1"><a class="reference internal" href="loggers.html">Loggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="operators.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot.html">Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="problem.html">Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="rnn.html">RNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulators.html">Simulators</a></li>
<li class="toctree-l1"><a class="reference internal" href="trainer.html">Trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="visuals.html">Visuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="arg.html">Arg</a></li>
<li class="toctree-l1"><a class="reference internal" href="callbacks.html">Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="component.html">Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="constraint.html">Constraint</a></li>
<li class="toctree-l1"><a class="reference internal" href="gradients.html">Gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="bounds.html">Bounds</a></li>
<li class="toctree-l1"><a class="reference internal" href="gnn.html">GNN</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Graph Dynamics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#graph_dynamics.GraphTimestepper"><code class="docutils literal notranslate"><span class="pre">GraphTimestepper</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#graph_dynamics.GraphTimestepper.DEFAULT_INPUT_KEYS"><code class="docutils literal notranslate"><span class="pre">GraphTimestepper.DEFAULT_INPUT_KEYS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#graph_dynamics.GraphTimestepper.DEFAULT_OUTPUT_KEYS"><code class="docutils literal notranslate"><span class="pre">GraphTimestepper.DEFAULT_OUTPUT_KEYS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#graph_dynamics.GraphTimestepper.decode"><code class="docutils literal notranslate"><span class="pre">GraphTimestepper.decode()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#graph_dynamics.GraphTimestepper.encode"><code class="docutils literal notranslate"><span class="pre">GraphTimestepper.encode()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#graph_dynamics.GraphTimestepper.forward"><code class="docutils literal notranslate"><span class="pre">GraphTimestepper.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#graph_dynamics.GraphTimestepper.process"><code class="docutils literal notranslate"><span class="pre">GraphTimestepper.process()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#graph_dynamics.GraphTimestepper.reg_error"><code class="docutils literal notranslate"><span class="pre">GraphTimestepper.reg_error()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="integrators.html">Integrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="loss.html">Loss</a></li>
<li class="toctree-l1"><a class="reference internal" href="maps.html">Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="ode.html">ODE</a></li>
<li class="toctree-l1"><a class="reference internal" href="pwa_maps.html">PWA Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="solvers.html">Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulator.html">Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="physics.html">Physics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NeuroMANCER</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Graph Dynamics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/graph_dynamics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="module-graph_dynamics">
<span id="graph-dynamics"></span><h1>Graph Dynamics<a class="headerlink" href="#module-graph_dynamics" title="Permalink to this heading">Â¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="graph_dynamics.GraphTimestepper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">graph_dynamics.</span></span><span class="sig-name descname"><span class="pre">GraphTimestepper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edge_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[128,</span> <span class="pre">128]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message_passing_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separate_batch_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_key_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_out_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'graph_timestepper'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/graph_dynamics.html#GraphTimestepper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#graph_dynamics.GraphTimestepper" title="Permalink to this definition">Â¶</a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="graph_dynamics.GraphTimestepper.DEFAULT_INPUT_KEYS">
<span class="sig-name descname"><span class="pre">DEFAULT_INPUT_KEYS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['x0',</span> <span class="pre">'Yf']</span></em><a class="headerlink" href="#graph_dynamics.GraphTimestepper.DEFAULT_INPUT_KEYS" title="Permalink to this definition">Â¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="graph_dynamics.GraphTimestepper.DEFAULT_OUTPUT_KEYS">
<span class="sig-name descname"><span class="pre">DEFAULT_OUTPUT_KEYS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['reg_error',</span> <span class="pre">'X_pred',</span> <span class="pre">'Y_pred']</span></em><a class="headerlink" href="#graph_dynamics.GraphTimestepper.DEFAULT_OUTPUT_KEYS" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Base State Space Model (SSM) class</p>
<p>This class is used to manage naming of component input and output variables as they flow
through the computational graph, as well as handle potential remapping of input and output keys
to different names. It additionally provides a useful reference for users to see how components
can be connected together in the overall computational graph.</p>
<p>Components that inherit from this class should specify the class attributes DEFAULT_INPUT_KEYS
and DEFAULT_OUTPUT_KEYS; these are used as the âcanonicalâ names for input and output variables,
respectively. These can be used to compare different componentsâ output and input keys to see
whether one component can accept anotherâs output by default.</p>
<p>By default, components have a <cite>name</cite> argument which is used to tag the output variables they
generate; for instance, for a component called âestimâ, the canonical output âx0â is renamed to
âx0_estimâ.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">estim</span> <span class="o">=</span> <span class="n">LinearEstimator</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;estim&quot;</span><span class="p">)</span>  <span class="c1"># output &quot;x0&quot; remapped to &quot;x0_estim&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssm</span> <span class="o">=</span> <span class="n">BlockSSM</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">input_key_map</span><span class="o">=</span><span class="p">{</span><span class="sa">f</span><span class="s2">&quot;x0_</span><span class="si">{</span><span class="n">estim</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="s2">&quot;x0&quot;</span><span class="p">})</span>  <span class="c1"># input_keys used to remap to canonical name</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="graph_dynamics.GraphTimestepper.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/graph_dynamics.html#GraphTimestepper.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#graph_dynamics.GraphTimestepper.decode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Transforms the graph features from the latent space to the output space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>G</strong> â [Graph_Features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[Graph_Features]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="graph_dynamics.GraphTimestepper.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/graph_dynamics.html#GraphTimestepper.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#graph_dynamics.GraphTimestepper.encode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Encodes graph features into the latent space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>G</strong> â [Graph_Features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[Graph_Features]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="graph_dynamics.GraphTimestepper.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/graph_dynamics.html#GraphTimestepper.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#graph_dynamics.GraphTimestepper.forward" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Forward pass of the module</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> â [{âx0â: Tensor, âYfâ: Tensor}]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[âreg_errorâ: Tensor, âlatent_stateâ: Tensor, âY_predâ: Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="graph_dynamics.GraphTimestepper.process">
<span class="sig-name descname"><span class="pre">process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/graph_dynamics.html#GraphTimestepper.process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#graph_dynamics.GraphTimestepper.process" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Processes a series of message passing steps on the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> â [Graph_Features]</p></li>
<li><p><strong>edge_index</strong> â [Tensor] Shape (2, edges)</p></li>
<li><p><strong>kwargs</strong> â Additional input to fx</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[Graph_Features]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="graph_dynamics.GraphTimestepper.reg_error">
<span class="sig-name descname"><span class="pre">reg_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/graph_dynamics.html#GraphTimestepper.reg_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#graph_dynamics.GraphTimestepper.reg_error" title="Permalink to this definition">Â¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="integrators.html" class="btn btn-neutral float-right" title="Integrators" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gnn.html" class="btn btn-neutral float-left" title="GNN" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Aaron Tuor, Jan Drgona, Mia Skomski, Stefan Dernbach, James Koch, Zhao Chen, Christian MÃ¸ldrup Legaard, Draguna Vrabie

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>